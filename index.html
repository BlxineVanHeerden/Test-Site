<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Invoice Generator - Plans</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
body{
  font-family:Inter,sans-serif;
  background:#f8fafc;
  padding:20px;
}

h1{text-align:center;color:#1e40af}

.section{
  background:#fff;
  padding:16px;
  border-radius:14px;
  margin-bottom:20px;
  box-shadow:0 6px 18px rgba(0,0,0,.06);
}

input,select,textarea,button{
  width:100%;
  padding:6px 8px;
  margin-top:6px;
  border-radius:6px;
  border:1px solid #cbd5e1;
  font-size:13px;
  box-sizing:border-box;
}

button{
  font-weight:600;
  border:none;
  cursor:pointer;
}

.button-group{
  display:flex;
  gap:10px;
  margin-bottom:20px;
}

.button-group button{
  flex:1;
  padding:6px 8px;
  font-size:13px;
}

.row{display:flex;gap:12px;flex-wrap:wrap}
.row>div{flex:1;min-width:180px}

.flex-row{display:flex;gap:12px;}
.flex-column{display:flex;flex-direction:column;gap:8px;}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  padding:8px;
  border-bottom:1px solid #e5e7eb;
}
th{background:#e5e7eb}

.badge{
  display:inline-block;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
}
.grey{background:#e5e7eb;color:#374151}
.blue{background:#3b82f6;color:#fff}
.green{background:#22c55e;color:#fff}
.red{background:#ef4444;color:#fff}

iframe{
  width:100%;
  height:720px;
  border-radius:14px;
  border:1px solid #e5e7eb;
  background:#f9fafb;
}

.remove-btn{
  background:#ef4444;
  padding:4px 8px;
  font-size:12px;
  border-radius:6px;
  cursor:pointer;
}
.remove-btn:hover{
  background:#b91c1c;
}

#note{
  height:80px;
  resize:vertical;
}

#dueDate{
  padding:5px 8px;
}

/* Plan cards */
.plan-card{
  border:1px solid #cbd5e1;
  border-radius:12px;
  padding:16px;
  flex:1;
  cursor:pointer;
  text-align:center;
  transition:all .2s;
}
.plan-card.selected{
  border-color:#3b82f6;
  box-shadow:0 4px 20px rgba(0,0,0,0.1);
}
.plan-price{
  font-size:20px;
  font-weight:600;
  margin:8px 0;
}
.plan-features{
  margin-top:10px;
  display:flex;
  flex-direction:column;
  gap:6px;
}
.feature-btn{
  padding:6px 12px;
  border-radius:6px;
  font-size:13px;
  cursor:pointer;
  background:#e5e7eb;
  color:#374151;
  border:none;
  transition:0.2s;
}
.feature-btn.unlocked{
  background:#3b82f6;
  color:#fff;
}
.feature-btn.locked{
  cursor:not-allowed;
  background:#e5e7eb;
  color:#9ca3af;
}

/* Tooltip */
.tooltip{
  position:relative;
  display:inline-block;
}
.tooltip .tooltiptext{
  visibility:hidden;
  width:180px;
  background-color:#111;
  color:#fff;
  text-align:left;
  border-radius:6px;
  padding:6px;
  position:absolute;
  z-index:1;
  bottom:125%;
  left:50%;
  margin-left:-90px;
  opacity:0;
  transition:opacity 0.3s;
  font-size:12px;
}
.tooltip:hover .tooltiptext{
  visibility:visible;
  opacity:1;
}
.tooltip-icon{
  display:inline-block;
  margin-left:4px;
  background:#3b82f6;
  color:#fff;
  border-radius:50%;
  width:14px;
  height:14px;
  font-size:10px;
  line-height:14px;
  text-align:center;
}
</style>
</head>
<body>

<h1>Smart Invoice Generator</h1>

<h2>Select a Plan</h2>
<div class="row" id="planContainer">
  <div class="plan-card" data-plan="free">
    <h3>Free</h3>
    <div class="plan-price">$0</div>
    <div class="plan-features">
      <div>Max 2 items</div>
      <div>Basic Invoice</div>
      <div>Share manually</div>
    </div>
  </div>
  <div class="plan-card" data-plan="basic">
    <h3>Basic</h3>
    <div class="plan-price">$7/mo</div>
    <div class="plan-features">
      <div>Max 10 items</div>
      <div>Invoice PDF download</div>
      <div>Email notifications</div>
    </div>
  </div>
  <div class="plan-card" data-plan="pro">
    <h3>Pro</h3>
    <div class="plan-price">$17/mo</div>
    <div class="plan-features">
      <div>Unlimited items</div>
      <div>Custom branding</div>
      <div>Automated reminders</div>
    </div>
  </div>
  <div class="plan-card" data-plan="enterprise">
    <h3>Enterprise</h3>
    <div class="plan-price">$30/mo</div>
    <div class="plan-features">
      <div>Team accounts</div>
      <div>Advanced analytics</div>
      <div>Priority support</div>
    </div>
  </div>
</div>

<div class="section row" id="invoiceSection">
  <div>
    <label>Document Type
      <span class="tooltip"><span class="tooltip-icon">i</span>
        <span class="tooltiptext">Choose whether this is an invoice, quote, or receipt</span>
      </span>
    </label>
    <select id="docType">
      <option value="INV">Invoice</option>
      <option value="QUO">Quote</option>
      <option value="REC">Receipt</option>
    </select>
  </div>
  <div>
    <label>Invoice Number
      <span class="tooltip"><span class="tooltip-icon">i</span>
        <span class="tooltiptext">Auto-generated invoice number</span>
      </span>
    </label>
    <div style="display:flex;gap:4px;">
      <input id="invoicePrefix" readonly style="width:60px;text-align:center;border-right:none;">
      <input id="invoiceNumber" style="flex:1;" placeholder="0001">
    </div>
  </div>
  <div>
    <label>Status
      <span class="tooltip"><span class="tooltip-icon">i</span>
        <span class="tooltiptext">Invoice status: Draft, Sent, or Paid</span>
      </span>
    </label>
    <select id="status">
      <option>Draft</option>
      <option>Sent</option>
      <option>Paid</option>
    </select>
  </div>
</div>

<div class="section row">
  <div>
    <h3>Your Info</h3>
    <input id="fromName" placeholder="Business name">
    <input id="fromEmail" placeholder="Email">
    <input id="fromPhone" placeholder="Contact number">
    <label>Logo (optional)</label>
    <input type="file" id="logoInput" accept="image/*">
  </div>
  <div>
    <h3>Client Info</h3>
    <input id="toName" placeholder="Client name">
    <input id="toEmail" placeholder="Client email">
    <input id="toPhone" placeholder="Client phone number">
  </div>
</div>

<div class="section">
  <h3>Invoice Items</h3>
  <table>
    <thead>
      <tr>
        <th>Item</th>
        <th>Category</th>
        <th>Qty</th>
        <th>Price</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="itemsBody"></tbody>
  </table>
  <button id="addItemBtn">Add Item</button>
</div>

<div class="section row">
  <div>
    <label>Currency</label>
    <select id="currency">
      <option value="$">USD ($)</option>
      <option value="€">EUR (€)</option>
      <option value="£">GBP (£)</option>
      <option value="R">ZAR (R)</option>
    </select>
  </div>
  <div>
    <label>Discount %</label>
    <input type="number" id="discount" value="0">
  </div>
  <div>
    <label>Tax %</label>
    <input type="number" id="tax" value="0">
  </div>
  <div>
    <label>Amount Paid</label>
    <input type="number" id="paid" value="0">
  </div>
</div>

<div class="section flex-row">
  <div class="flex-column" style="flex:1">
    <label>Payment Terms</label>
    <select id="terms">
      <option value="0">Due on receipt</option>
      <option value="7">Net 7</option>
      <option value="14">Net 14</option>
      <option value="30">Net 30</option>
    </select>
    <label>Due Date</label>
    <input type="date" id="dueDate">
  </div>
  <div style="flex:1">
    <label>Client Note</label>
    <textarea id="note"></textarea>
  </div>
</div>

<div class="button-group">
  <button class="feature-btn" id="previewBtn">Preview Invoice</button>
  <button class="feature-btn" id="pdfBtn">Download PDF</button>
  <button class="feature-btn" id="sendBtn">Send Invoice</button>
  <button class="feature-btn" id="saveBtn">Save Invoice</button>
</div>

<h3>Invoice Preview</h3>
<iframe id="preview"></iframe>

<script>
// ----- Plan logic -----
const planButtons=document.querySelectorAll('.plan-card');
let selectedPlan='free';

planButtons.forEach(card=>{
  card.addEventListener('click',()=>{
    selectedPlan=card.getAttribute('data-plan');
    planButtons.forEach(c=>c.classList.remove('selected'));
    card.classList.add('selected');
    updateFeatureAccess();
  });
});

function updateFeatureAccess(){
  const pdfBtn=document.getElementById("pdfBtn");
  const sendBtn=document.getElementById("sendBtn");
  const saveBtn=document.getElementById("saveBtn");

  if(selectedPlan==="free"){
    pdfBtn.className="feature-btn locked";
    sendBtn.className="feature-btn locked";
    saveBtn.className="feature-btn unlocked";
  }else if(selectedPlan==="basic"){
    pdfBtn.className="feature-btn unlocked";
    sendBtn.className="feature-btn unlocked";
    saveBtn.className="feature-btn unlocked";
  }else{ // pro & enterprise
    pdfBtn.className="feature-btn unlocked";
    sendBtn.className="feature-btn unlocked";
    saveBtn.className="feature-btn unlocked";
  }
}

// ----- Invoice logic -----
const categories=[
"Professional Services","Consulting","Construction","Automotive",
"Healthcare","Education","Retail","Manufacturing","Hospitality",
"Logistics","Freelance","Agriculture","Media","Legal","Finance",
"Real Estate","IT & Technology","Cleaning","Security","Events","Miscellaneous"
];

const counters={INV:0,QUO:0,REC:0};
const docType=document.getElementById("docType");
const invoicePrefix=document.getElementById("invoicePrefix");
const invoiceNumber=document.getElementById("invoiceNumber");

function updateInvoiceNumber(){
  counters[docType.value]++;
  invoicePrefix.value = docType.value;
  invoiceNumber.value = String(counters[docType.value]).padStart(4,"0");
}
updateInvoiceNumber();
docType.addEventListener("change",updateInvoiceNumber);

let items=[];
const itemsBody=document.getElementById("itemsBody");

function addItem(){
  const index=items.length;
  items.push({name:"",cat:"",qty:1,price:0});

  const tr=document.createElement("tr");

  const nameTd=document.createElement("td");
  const nameInput=document.createElement("input");
  nameInput.oninput=e=>{items[index].name=e.target.value; updatePreview();}
  nameTd.appendChild(nameInput);

  const catTd=document.createElement("td");
  const catSelect=document.createElement("select");
  categories.forEach(c=>{
    const o=document.createElement("option");
    o.textContent=c;
    catSelect.appendChild(o);
  });
  catSelect.onchange=e=>{items[index].cat=e.target.value; updatePreview();}
  catTd.appendChild(catSelect);

  const qtyTd=document.createElement("td");
  const qtyInput=document.createElement("input");
  qtyInput.type="number";
  qtyInput.value=1;
  qtyInput.min=1;
  qtyInput.oninput=e=>{items[index].qty=Number(e.target.value); updatePreview();}
  qtyTd.appendChild(qtyInput);

  const priceTd=document.createElement("td");
  const priceInput=document.createElement("input");
  priceInput.type="number";
  priceInput.value=0;
  priceInput.min=0;
  priceInput.oninput=e=>{items[index].price=Number(e.target.value); updatePreview();}
  priceTd.appendChild(priceInput);

  const actionTd=document.createElement("td");
  const removeBtn=document.createElement("button");
  removeBtn.className="remove-btn";
  removeBtn.textContent="Remove";
  removeBtn.onclick=()=>{items.splice(index,1); tr.remove(); updatePreview();}
  actionTd.appendChild(removeBtn);

  tr.append(nameTd,catTd,qtyTd,priceTd,actionTd);
  itemsBody.appendChild(tr);
}

document.getElementById("addItemBtn").addEventListener("click",addItem);
addItem();

const terms=document.getElementById("terms");
const dueDate=document.getElementById("dueDate");

terms.addEventListener("change",()=>{
  const d=new Date();
  d.setDate(d.getDate()+Number(terms.value));
  dueDate.value=d.toISOString().split("T")[0];
  updatePreview();
});
terms.dispatchEvent(new Event("change"));

let logoData="";
document.getElementById("logoInput").addEventListener("change",e=>{
  const file=e.target.files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=ev=>{ logoData=ev.target.result; updatePreview();}
    reader.readAsDataURL(file);
  }
});

["fromName","fromEmail","fromPhone","toName","toEmail","toPhone","discount","tax","paid","note","currency","status","invoiceNumber","dueDate"].forEach(id=>{
  document.getElementById(id).addEventListener("input",updatePreview);
});
invoicePrefix.addEventListener("input",()=>{invoicePrefix.value = docType.value;});

function updatePreview(){
  const cur=document.getElementById("currency").value;
  let subtotal=0;

  const rows=items.map(i=>{
    const t=i.qty*i.price;
    subtotal+=t;
    return `<tr>
      <td>${i.name||"-"}<br><small>${i.cat||""}</small></td>
      <td>${i.qty}</td>
      <td>${cur}${t.toFixed(2)}</td>
    </tr>`;
  }).join("");

  const disc=subtotal*(document.getElementById("discount").value/100);
  const taxAmt=subtotal*(document.getElementById("tax").value/100);
  const total=subtotal-disc+taxAmt;
  const balance=total-document.getElementById("paid").value;

  const due=new Date(dueDate.value);
  const overdue=balance>0 && new Date()>due;

  let badge="grey",text=document.getElementById("status").value;
  if(text==="Paid") badge="green";
  if(text==="Sent") badge="blue";
  if(overdue){badge="red";text="Overdue";}

  const preview=document.getElementById("preview");

  preview.srcdoc=`<div style="font-family:Inter;padding:32px;background:#fff;border-radius:12px;margin:16px;box-shadow:0 6px 18px rgba(0,0,0,0.08)">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <h2 style="color:#1e40af;margin:0">${docType.selectedOptions[0].text} ${invoicePrefix.value}${invoiceNumber.value}</h2>
      <span class="badge ${badge}">${text}</span>
    </div>
    ${logoData?`<img src="${logoData}" style="height:60px;margin-top:12px">`:''}
    <div style="display:flex;justify-content:space-between;margin-top:20px">
      <div>
        <strong>${document.getElementById("fromName").value}</strong><br>
        ${document.getElementById("fromEmail").value}<br>
        ${document.getElementById("fromPhone").value?`Phone: ${document.getElementById("fromPhone").value}`:''}
      </div>
      <div>
        <strong>Bill To:</strong><br>
        ${document.getElementById("toName").value}<br>
        ${document.getElementById("toEmail").value}<br>
        ${document.getElementById("toPhone").value?`Phone: ${document.getElementById("toPhone").value}`:''}
      </div>
    </div>
    <table style="width:100%;margin-top:20px;border-collapse:collapse">
      <thead>
        <tr>
          <th style="text-align:left;border-bottom:1px solid #e5e7eb">Item</th>
          <th style="border-bottom:1px solid #e5e7eb">Qty</th>
          <th style="border-bottom:1px solid #e5e7eb">Price</th>
        </tr>
      </thead>
      <tbody>
        ${rows}
      </tbody>
    </table>
    <div style="text-align:right;margin-top:12px">
      Subtotal: ${cur}${subtotal.toFixed(2)}<br>
      Discount: ${cur}${disc.toFixed(2)}<br>
      Tax: ${cur}${taxAmt.toFixed(2)}<br>
      <strong>Total: ${cur}${total.toFixed(2)}</strong><br>
      Amount Paid: ${cur}${Number(document.getElementById("paid").value).toFixed(2)}<br>
      <strong>Balance: ${cur}${balance.toFixed(2)}</strong><br>
      Due Date: ${dueDate.value}<br>
      Note: ${document.getElementById("note").value}
    </div>
  </div>`;
}

// ----- Buttons -----
document.getElementById("previewBtn").addEventListener("click",updatePreview);
document.getElementById("pdfBtn").addEventListener("click",()=>{
  if(selectedPlan!=="free") alert("Download PDF");
});
document.getElementById("sendBtn").addEventListener("click",()=>{
  if(selectedPlan!=="free") alert("Send Invoice");
});
document.getElementById("saveBtn").addEventListener("click",()=>alert("Save Invoice"));

// ----- Initialize -----
updateFeatureAccess();
updatePreview();
</script>

</body>
</html>
