<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Invoice Generator</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
body{
  font-family:Inter,sans-serif;
  background:#f8fafc;
  padding:20px;
}
h1{text-align:center;color:#1e40af}

.section{
  background:#fff;
  padding:16px;
  border-radius:14px;
  margin-bottom:20px;
  box-shadow:0 6px 18px rgba(0,0,0,.06);
}

input,select,textarea,button{
  width:100%;
  padding:9px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #cbd5e1;
}

button{
  background:#1e40af;
  color:#fff;
  cursor:pointer;
  font-weight:600;
}
button:hover{background:#1e3a8a}

.row{display:flex;gap:12px;flex-wrap:wrap}
.row>div{flex:1;min-width:180px}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th,td{
  padding:10px;
  border-bottom:1px solid #e5e7eb;
}
th{background:#e5e7eb}

.badge{
  display:inline-block;
  padding:6px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
}
.grey{background:#e5e7eb;color:#374151}
.blue{background:#bfdbfe;color:#1e40af}
.green{background:#bbf7d0;color:#166534}
.red{background:#fecaca;color:#991b1b}

iframe{
  width:100%;
  height:700px;
  border-radius:14px;
  border:1px solid #e5e7eb;
}
</style>
</head>
<body>

<h1>Invoice Generator</h1>

<div class="section row">
  <div>
    <label>Document Type</label>
    <select id="docType"></select>
  </div>
  <div>
    <label>Invoice Number</label>
    <input id="invoiceNumber" readonly>
  </div>
  <div>
    <label>Status</label>
    <select id="status">
      <option>Draft</option>
      <option>Sent</option>
      <option>Paid</option>
    </select>
  </div>
</div>

<div class="section row">
  <div>
    <h3>Your Info</h3>
    <input id="fromName" placeholder="Business name">
    <input id="fromEmail" placeholder="Email">
  </div>
  <div>
    <h3>Client Info</h3>
    <input id="toName" placeholder="Client name">
    <input id="toEmail" placeholder="Client email">
  </div>
</div>

<div class="section">
  <h3>Invoice Items</h3>
  <table>
    <thead>
      <tr>
        <th>Item</th>
        <th>Note</th>
        <th>Qty</th>
        <th>Price</th>
      </tr>
    </thead>
    <tbody id="items"></tbody>
  </table>
  <button onclick="addItem()">Add Item</button>
</div>

<div class="section row">
  <div>
    <label>Currency</label>
    <select id="currency">
      <option value="$">USD ($)</option>
      <option value="€">EUR (€)</option>
      <option value="£">GBP (£)</option>
      <option value="R">ZAR (R)</option>
    </select>
  </div>
  <div>
    <label>Discount %</label>
    <input type="number" id="discount" value="0">
  </div>
  <div>
    <label>Tax %</label>
    <input type="number" id="tax" value="0">
  </div>
  <div>
    <label>Amount Paid</label>
    <input type="number" id="paid" value="0">
  </div>
</div>

<div class="section row">
  <div>
    <label>Payment Terms</label>
    <select id="terms">
      <option value="0">Due on receipt</option>
      <option value="7">Net 7</option>
      <option value="14">Net 14</option>
      <option value="30">Net 30</option>
    </select>
  </div>
  <div>
    <label>Due Date</label>
    <input id="dueDate" readonly>
  </div>
</div>

<div class="section">
  <label>Client Note</label>
  <textarea id="note"></textarea>
</div>

<button onclick="previewInvoice()">Preview Invoice</button>

<h3>Preview</h3>
<iframe id="preview"></iframe>

<script>
const docTypes={INV:0,QUO:0,REC:0};
const docTypeEl=document.getElementById("docType");
["INV","QUO","REC"].forEach(t=>{
  let o=document.createElement("option");
  o.value=t;
  o.textContent=t==="INV"?"Invoice":t==="QUO"?"Quote":"Receipt";
  docTypeEl.appendChild(o);
});

function updateInvoiceNumber(){
  const t=docTypeEl.value;
  docTypes[t]++;
  invoiceNumber.value=`${t}-${String(docTypes[t]).padStart(4,"0")}`;
}
updateInvoiceNumber();
docTypeEl.onchange=updateInvoiceNumber;

let items=[];
function addItem(){
  const i=items.length;
  items.push({name:"",note:"",qty:1,price:0});
  itemsEl.innerHTML+=`
    <tr>
      <td><input oninput="items[${i}].name=this.value"></td>
      <td><input oninput="items[${i}].note=this.value"></td>
      <td><input type="number" value="1" min="1"
        oninput="items[${i}].qty=this.value"></td>
      <td><input type="number" value="0" min="0"
        oninput="items[${i}].price=this.value"></td>
    </tr>`;
}
addItem();

terms.onchange=()=>{
  const d=new Date();
  d.setDate(d.getDate()+Number(terms.value));
  dueDate.value=d.toISOString().split("T")[0];
};
terms.onchange();

function previewInvoice(){
  const cur=currency.value;
  let subtotal=0;
  let rows=items.map(i=>{
    const t=i.qty*i.price;
    subtotal+=t;
    return `
      <tr>
        <td>${i.name}<br><small>${i.note}</small></td>
        <td>${i.qty}</td>
        <td>${cur}${t.toFixed(2)}</td>
      </tr>`;
  }).join("");

  const disc=subtotal*(discount.value/100);
  const taxAmt=subtotal*(tax.value/100);
  const total=subtotal-disc+taxAmt;
  const balance=total-paid.value;

  const due=new Date(dueDate.value);
  const overdue=balance>0 && new Date()>due;
  let statusClass=status.value==="Paid"?"green":status.value==="Sent"?"blue":"grey";
  let statusText=status.value;
  if(overdue){statusClass="red";statusText="Overdue";}

  preview.srcdoc=`
  <div style="font-family:Inter;padding:32px">
    <span class="badge ${statusClass}">${statusText}</span>
    <h2>${docTypeEl.selectedOptions[0].text} ${invoiceNumber.value}</h2>

    <p><strong>${fromName.value}</strong><br>
    Bill To: ${toName.value}</p>

    <table style="width:100%;margin-top:20px">
      <tr><th>Item</th><th>Qty</th><th>Total</th></tr>
      ${rows}
    </table>

    <div style="margin-top:20px;max-width:300px;margin-left:auto">
      <p>Subtotal: ${cur}${subtotal.toFixed(2)}</p>
      <p>Discount: -${cur}${disc.toFixed(2)}</p>
      <p>Tax: ${cur}${taxAmt.toFixed(2)}</p>
      <p><strong>Total Due: ${cur}${total.toFixed(2)}</strong></p>
      <p>Amount Paid: ${cur}${paid.value}</p>
      <p><strong>Balance: ${cur}${balance.toFixed(2)}</strong></p>
    </div>

    <p><strong>Due Date:</strong> ${dueDate.value}</p>

    ${note.value?`<p><strong>Note:</strong><br>${note.value}</p>`:""}
  </div>`;
}
</script>

</body>
</html>
