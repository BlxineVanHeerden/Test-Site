<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Modern Invoice Generator - Templates A & B</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Inter', sans-serif;
    background: #f0f4f8;
    margin: 0; padding: 20px;
  }
  h1 { text-align:center; color:#1e40af; margin-bottom:20px; }

  /* Sections */
  .section {
    background:white;
    padding:15px;
    border-radius:10px;
    margin-bottom:20px;
    box-shadow:0 2px 5px rgba(0,0,0,0.1);
  }

  input, select, button {
    padding:8px;
    margin:5px 0;
    border-radius:5px;
    border:1px solid #ccc;
    font-size:14px;
    width:100%;
    box-sizing:border-box;
  }

  button {
    background:#1e40af;
    color:white;
    cursor:pointer;
    transition:0.2s;
  }

  button:hover { background:#1e3a8a; }

  /* Row flex */
  .row-flex { display:flex; gap:10px; flex-wrap:wrap; }
  .row-flex > div { flex:1; min-width:150px; }

  /* Items Table */
  table { width:100%; border-collapse:collapse; margin-top:10px; }
  th, td { padding:10px; text-align:left; border-bottom:1px solid #ccc; }
  th { background:#bfdbfe; } /* Light blue header */
  td input, td select { width:90%; }

  /* Health bar */
  .health-bar-container {
    width:100%; background:#e0f2fe; border-radius:10px; height:12px; margin-top:5px;
  }
  .health-bar { height:100%; width:0%; background:red; border-radius:10px; transition:0.3s; }

  /* Buttons row */
  .button-row { display:flex; gap:10px; flex-wrap:wrap; }
  .button-row button { flex:1; }

  /* Premium buttons */
  .premium {
    background:#94a3b8 !important;
    cursor:not-allowed;
    opacity:0.7;
    position:relative;
  }
  .premium::after {
    content:'Premium';
    font-size:10px;
    position:absolute;
    top:3px; right:5px;
    color:white;
    font-weight:bold;
  }

  /* Preview iframe */
  iframe { width:100%; height:600px; border:1px solid #ccc; border-radius:8px; margin-top:20px; }

  /* Template specific */
  .template-a h2 { color:#1e40af; border-bottom:2px solid #1e40af; padding-bottom:5px; }
  .template-b h2 { color:#1e3a8a; text-align:center; margin-bottom:10px; }
</style>
</head>
<body>

<h1>Modern Invoice Generator</h1>

<div class="section">
  <label>Choose Template:</label>
  <select id="templateSelect">
    <option value="A">Template A - Full Header</option>
    <option value="B">Template B - Card Style</option>
  </select>
</div>

<div class="section row-flex">
  <div>
    <h3>Your Info</h3>
    <input id="yourName" placeholder="Your Name / Business Name">
    <input id="yourEmail" placeholder="Email">
    <input id="yourPhone" placeholder="Phone">
  </div>
  <div>
    <h3>Client Info</h3>
    <input id="clientName" placeholder="Client Name">
    <input id="clientEmail" placeholder="Client Email">
    <input id="clientPhone" placeholder="Client Phone">
  </div>
</div>

<div class="section">
  <h3>Invoice Items</h3>
  <table id="itemsTable">
    <thead>
      <tr>
        <th>Item</th>
        <th>Category</th>
        <th>Qty</th>
        <th>Price</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <button id="addItemBtn">Add Item</button>
</div>

<div class="section row-flex">
  <div>
    <label>Currency:</label>
    <select id="currencySelect"></select>
  </div>
  <div>
    <label>Discount %:</label>
    <input type="number" id="discount" value="0">
  </div>
  <div>
    <label>Tax %:</label>
    <input type="number" id="taxRate" value="0">
  </div>
  <div>
    <label>Payment Status:</label>
    <select id="paymentStatus">
      <option value="Unpaid">Unpaid</option>
      <option value="Paid">Paid</option>
      <option value="Draft">Draft</option>
      <option value="Sent">Sent</option>
      <option value="Overdue">Overdue</option>
    </select>
  </div>
</div>

<div class="section">
  <label>Due Date:</label>
  <input type="date" id="dueDate">
</div>

<div class="section">
  <strong>Invoice Health:</strong>
  <div class="health-bar-container">
    <div class="health-bar" id="healthBar"></div>
  </div>
</div>

<div class="section">
  <label>Client Note:</label>
  <textarea id="clientNote" rows="3" placeholder="Add a note for your client"></textarea>
</div>

<div class="button-row">
  <button id="previewBtn">Preview Invoice</button>
  <button class="premium">Export PDF</button>
  <button class="premium">Save Invoice</button>
  <button class="premium">Remove Branding</button>
  <button class="premium">Duplicate Invoice</button>
</div>

<h3>Invoice Preview</h3>
<iframe id="invoicePreview"></iframe>

<script>
/* ------------------- DATA ------------------- */
const currencies = ["USD","EUR","GBP","JPY","AUD","CAD","CNY","INR","BRL","ZAR","NZD"];
const currencySelect = document.getElementById('currencySelect');
currencies.forEach(c => { let opt=document.createElement('option'); opt.value=c; opt.textContent=c; currencySelect.appendChild(opt); });

const categories = ["Web Design","Hosting & IT","Maintenance & Repairs","Consulting","Marketing","Retail","Education","Healthcare","Miscellaneous"];

/* ------------------- ITEMS ------------------- */
let items = [];
const itemsTableBody = document.querySelector("#itemsTable tbody");
const addItemBtn = document.getElementById("addItemBtn");

function createItemRow(){
  const rowIndex = items.length;
  items.push({name:"",category:categories[0],qty:1,price:0});
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td><input type="text" placeholder="Item name"></td>
    <td><select></select></td>
    <td><input type="number" value="1" min="1"></td>
    <td><input type="number" value="0" min="0"></td>
  `;
  const catSelect = tr.children[1].querySelector("select");
  categories.forEach(cat=>{
    let opt=document.createElement("option");
    opt.value=cat; opt.textContent=cat;
    catSelect.appendChild(opt);
  });

  const nameInput = tr.children[0].querySelector("input");
  const qtyInput = tr.children[2].querySelector("input");
  const priceInput = tr.children[3].querySelector("input");

  nameInput.addEventListener("input", ()=>{ items[rowIndex].name=nameInput.value; updateHealth(); });
  catSelect.addEventListener("change", ()=>{ items[rowIndex].category=catSelect.value; updateHealth(); });
  qtyInput.addEventListener("input", ()=>{ items[rowIndex].qty=parseInt(qtyInput.value)||1; updateHealth(); });
  priceInput.addEventListener("input", ()=>{ items[rowIndex].price=parseFloat(priceInput.value)||0; updateHealth(); });

  itemsTableBody.appendChild(tr);
}

addItemBtn.addEventListener("click", createItemRow);
createItemRow(); // initial row

/* ------------------- HEALTH BAR ------------------- */
const healthBarEl = document.getElementById("healthBar");
function updateHealth(){
  let totalFields = items.length*3 + 6;
  let filled = 0;
  items.forEach(it=>{
    if(it.name) filled++;
    if(it.category) filled++;
    if(it.qty>0) filled++;
    if(it.price>0) filled++;
  });
  ['yourName','yourEmail','yourPhone','clientName','clientEmail','clientPhone'].forEach(id=>{
    if(document.getElementById(id).value.trim()!=="") filled++;
  });
  let score=Math.min(100, Math.round((filled/totalFields)*80 + 10));
  healthBarEl.style.width=score+"%";
  healthBarEl.style.backgroundColor = score<40?"red":score<70?"yellow":"green";
}

document.querySelectorAll('input, select, textarea').forEach(el=>{
  el.addEventListener("input",updateHealth);
  el.addEventListener("change",updateHealth);
});
updateHealth();

/* ------------------- INVOICE PREVIEW ------------------- */
const previewBtn = document.getElementById("previewBtn");
previewBtn.addEventListener("click", ()=>{
  const currency = currencySelect.value;
  const template = document.getElementById("templateSelect").value;
  const dueDate = document.getElementById("dueDate").value;
  let subtotal=0;
  let html = `<div class="template-${template}">
  <h2>${document.getElementById("invoiceType")?.value || "Invoice"}</h2>
  <p><strong>Invoice Number:</strong> ${document.getElementById("invoiceType")?.value || "INV"}-001</p>
  <p><strong>Due Date:</strong> ${dueDate || "Not set"}</p>
  <hr>
  <p><strong>From:</strong> ${document.getElementById("yourName").value} (${document.getElementById("yourEmail").value}, ${document.getElementById("yourPhone").value})</p>
  <p><strong>To:</strong> ${document.getElementById("clientName").value} (${document.getElementById("clientEmail").value}, ${document.getElementById("clientPhone").value})</p>
  <table border="1" cellpadding="5" cellspacing="0" style="border-collapse:collapse; width:100%; margin-top:10px;">
  <tr><th>Item</th><th>Category</th><th>Qty</th><th>Price (${currency})</th><th>Total</th></tr>`;
  items.forEach(it=>{
    const total = it.qty*it.price;
    subtotal += total;
    html += `<tr>
      <td>${it.name}</td>
      <td>${it.category}</td>
      <td>${it.qty}</td>
      <td>${it.price.toFixed(2)}</td>
      <td>${total.toFixed(2)}</td>
    </tr>`;
  });
  const discount = parseFloat(document.getElementById("discount").value)||0;
  const tax = parseFloat(document.getElementById("taxRate").value)||0;
  const discounted = subtotal*(1-discount/100);
  const total = discounted*(1+tax/100);
  html += `</table>
  <div style="margin-top:10px; padding:10px; border:1px solid #ccc; border-radius:5px; background:#e0f2fe;">
  <p>Subtotal: ${subtotal.toFixed(2)} ${currency}</p>
  <p>Discount: ${discount}%</p>
  <p>Tax: ${tax}%</p>
  <h3>Total: ${total.toFixed(2)} ${currency}</h3>
  <p>Payment Status: ${document.getElementById("paymentStatus").value}</p>
  <p>Client Note: ${document.getElementById("clientNote").value}</p>
  </div></div>`;
  document.getElementById("invoicePreview").srcdoc = html;
});
</script>
</body>
</html>
