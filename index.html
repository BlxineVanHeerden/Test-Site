<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Invoice Generator - Plans</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
body{
  font-family:Inter,sans-serif;
  background:#f5f7fb;
  padding:20px;
  color:#1f2937;
}
h1{text-align:center;color:#111827;font-weight:700;margin-bottom:10px;}
h2,h3{color:#1f2937;}
.section{
  background:#fff;
  padding:20px;
  border-radius:16px;
  margin-bottom:24px;
  box-shadow:0 10px 25px rgba(0,0,0,.06);
  transition:all .3s;
}
input,select,textarea,button{
  width:100%;
  padding:10px 12px;
  margin-top:8px;
  border-radius:8px;
  border:1px solid #d1d5db;
  font-size:14px;
  box-sizing:border-box;
  transition:border .3s,background .3s,color .3s;
}
input:focus, select:focus, textarea:focus{
  outline:none;
  border-color:#3b82f6;
  box-shadow:0 0 0 2px rgba(59,130,246,0.2);
}
button{
  font-weight:600;
  border:none;
  cursor:pointer;
  transition:all .2s;
  background:#3b82f6;
  color:#fff;
}
button:hover{
  background:#2563eb;
}
.button-group{display:flex;gap:12px;flex-wrap:wrap;}
.button-group button{flex:1;padding:10px;font-size:14px;}
.row{display:flex;gap:16px;flex-wrap:wrap}
.row>div{flex:1;min-width:200px}
.flex-row{display:flex;gap:16px;}
.flex-column{display:flex;flex-direction:column;gap:10px;}
table{width:100%;border-collapse:collapse;margin-top:12px;}
th,td{padding:12px;border-bottom:1px solid #e5e7eb;}
th{background:#f3f4f6;text-align:left;}
.plan-card{border:1px solid #d1d5db;border-radius:16px;padding:20px;flex:1;cursor:pointer;text-align:center;transition:all .3s, transform .2s;background:#fff;}
.plan-card:hover{transform:translateY(-4px);box-shadow:0 12px 24px rgba(0,0,0,0.12);}
.plan-card.selected{border-color:#3b82f6;box-shadow:0 12px 28px rgba(59,130,246,0.2);}
.plan-price{font-size:22px;font-weight:700;margin:10px 0;background:linear-gradient(90deg,#3b82f6,#60a5fa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.plan-features{margin-top:12px;display:flex;flex-direction:column;gap:8px;}
.feature-btn{padding:6px 10px;border-radius:8px;font-size:13px;cursor:not-allowed;background:#e5e7eb;color:#374151;}
.feature-btn.unlocked{background:#3b82f6;color:#fff;cursor:pointer;transition:all .2s;}
.feature-btn.unlocked:hover{background:#2563eb;}
.remove-btn{background:#ef4444;padding:6px 12px;font-size:13px;border-radius:8px;cursor:pointer;color:#fff;transition:all .2s;}
.remove-btn:hover{background:#b91c1c;}
iframe{width:100%;height:720px;border-radius:16px;border:none;background:#f9fafb;box-shadow:0 10px 24px rgba(0,0,0,0.08);transition:all .3s;}
#note{height:90px;resize:vertical;}
</style>
</head>
<body>

<h1>Smart Invoice Generator</h1>

<h2>Select a Plan</h2>
<div class="row" id="planContainer">
  <div class="plan-card" data-plan="free">
    <h3>Free</h3>
    <div class="plan-price">$0</div>
    <div class="plan-features">
      <div>Max 2 items</div>
      <div>Preview Only</div>
    </div>
  </div>
  <div class="plan-card" data-plan="basic">
    <h3>Basic</h3>
    <div class="plan-price">$5/mo</div>
    <div class="plan-features">
      <div>Max 10 items</div>
      <div>Invoice PDF download</div>
      <div>Email notifications</div>
    </div>
  </div>
  <div class="plan-card" data-plan="pro">
    <h3>Pro</h3>
    <div class="plan-price">$10/mo</div>
    <div class="plan-features">
      <div>Unlimited items</div>
      <div>Custom branding</div>
      <div>Automated reminders</div>
    </div>
  </div>
</div>

<div id="paypalSection" class="section" style="display:none">
  <h3>Pay with PayPal (Sandbox)</h3>
  <div id="paypal-button-container"></div>
</div>

<!-- Invoice Section (always visible) -->
<div id="invoiceSection" class="section">
  <h3>Invoice Items</h3>
  <table>
    <thead>
      <tr>
        <th>Item</th><th>Qty</th><th>Price</th><th>Action</th>
      </tr>
    </thead>
    <tbody id="itemsBody"></tbody>
  </table>
  <button id="addItemBtn">Add Item</button>

  <div class="button-group">
    <button onclick="updatePreview()">Preview Invoice</button>
    <button id="pdfBtn" class="feature-btn">Download PDF</button>
    <button id="sendBtn" class="feature-btn">Send Invoice</button>
    <button id="saveBtn" class="feature-btn">Save</button>
  </div>
</div>

<h3>Invoice Preview</h3>
<iframe id="preview"></iframe>

<script src="https://www.paypal.com/sdk/js?client-id=ASrqoC_iNPodEFNeqORNw&currency=USD"></script>
<script>
// --- Plan logic ---
const planButtons=document.querySelectorAll('.plan-card');
let selectedPlan='free';
let planPaid={free:true,basic:false,pro:false};

planButtons.forEach(card=>{
  card.addEventListener('click',()=>{
    selectedPlan=card.getAttribute('data-plan');
    planButtons.forEach(c=>c.classList.remove('selected'));
    card.classList.add('selected');

    // Show or hide PayPal button
    if(planPaid[selectedPlan] || selectedPlan==='free'){
      document.getElementById('paypalSection').style.display='none';
    } else {
      document.getElementById('paypalSection').style.display='block';
    }

    updateFeatureAccess();
    updatePreview();
  });
});

function updateFeatureAccess(){
  const pdfBtn=document.getElementById('pdfBtn');
  const sendBtn=document.getElementById('sendBtn');
  const saveBtn=document.getElementById('saveBtn');

  if(selectedPlan==='free'){
    pdfBtn.classList.remove('unlocked');
    sendBtn.classList.remove('unlocked');
    saveBtn.classList.remove('unlocked');
  } else if(selectedPlan==='basic'){
    pdfBtn.classList.add('unlocked');
    sendBtn.classList.remove('unlocked');
    saveBtn.classList.add('unlocked');
  } else if(selectedPlan==='pro'){
    pdfBtn.classList.add('unlocked');
    sendBtn.classList.add('unlocked');
    saveBtn.classList.add('unlocked');
  }
}

// --- PayPal ---
paypal.Buttons({
  createOrder:(data,actions)=>{
    let amount=0;
    if(selectedPlan==='basic') amount=5;
    else if(selectedPlan==='pro') amount=10;
    return actions.order.create({purchase_units:[{amount:{value:amount}}]});
  },
  onApprove:(data,actions)=>{
    return actions.order.capture().then(details=>{
      alert(`Payment successful for ${selectedPlan} plan!`);
      planPaid[selectedPlan]=true;
      document.getElementById('paypalSection').style.display='none';
      updateFeatureAccess();
    });
  }
}).render('#paypal-button-container');

// --- Invoice logic ---
let items=[];
const itemsBody=document.getElementById("itemsBody");
function addItem(){
  const index=items.length;
  items.push({name:"Item",qty:1,price:0});
  const tr=document.createElement("tr");
  tr.innerHTML=`
    <td><input value="Item" oninput="items[${index}].name=this.value;updatePreview()"></td>
    <td><input type="number" value="1" min="1" oninput="items[${index}].qty=Number(this.value);updatePreview()"></td>
    <td><input type="number" value="0" min="0" oninput="items[${index}].price=Number(this.value);updatePreview()"></td>
    <td><button class="remove-btn" onclick="items.splice(${index},1);this.parentElement.parentElement.remove();updatePreview()">Remove</button></td>
  `;
  itemsBody.appendChild(tr);
}
document.getElementById("addItemBtn").addEventListener("click",addItem);
addItem();

// --- Invoice preview ---
function updatePreview(){
  const cur="$";
  let subtotal=0;
  const rows=items.map(i=>{
    const t=i.qty*i.price;
    subtotal+=t;
    return `<tr><td>${i.name}</td><td>${i.qty}</td><td>${cur}${t.toFixed(2)}</td></tr>`;
  }).join("");
  const html=`<div style="font-family:Inter,sans-serif;padding:20px;background:#f9fafb">
    <h2>Invoice Preview</h2>
    <table style="width:100%;border-collapse:collapse">
      <tr style="background:#3b82f6;color:#fff"><th>Item</th><th>Qty</th><th>Total</th></tr>
      ${rows}
    </table>
    <p>Subtotal: ${cur}${subtotal.toFixed(2)}</p>
  </div>`;
  document.getElementById("preview").srcdoc=html;
}

// Initialize
document.querySelector('.plan-card[data-plan="free"]').click();
updatePreview();
</script>

</body>
</html>
