<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Modern Invoice Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Inter', sans-serif; background: #f0f4f8; margin: 0; padding: 20px; }
  h1 { text-align:center; color:#2f855a; }
  input, select, button { padding:8px; margin:5px 0; border-radius:5px; border:1px solid #ccc; font-size:14px; width:100%; box-sizing:border-box; }
  button { background:#2f855a; color:white; cursor:pointer; transition:0.2s; }
  button:hover{ background:#276749; }
  .section{ margin-bottom:20px; background:white; padding:15px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
  table{ width:100%; border-collapse:collapse; margin-top:10px; border-radius:8px; overflow:hidden; }
  th, td{ padding:10px; text-align:left; border-bottom:1px solid #ccc; }
  th{ background:#a7f3d0; color:#1f2937; font-weight:600; }
  tr:nth-child(even){ background:#f0fdf4; }
  #invoicePreview{ width:100%; height:600px; border:1px solid #ccc; border-radius:8px; margin-top:20px; }
  .health-bar-container{ width:100%; background:#e6f4ea; border-radius:10px; height:12px; margin-top:5px; }
  .health-bar{ height:100%; width:0%; background:red; border-radius:10px; transition:0.3s; }
  .row-flex{ display:flex; gap:10px; flex-wrap:wrap; }
  .row-flex > div{ flex:1; min-width:150px; }
</style>
</head>
<body>

<h1>Modern Invoice Generator</h1>

<div class="section">
  <label>Type:</label>
  <select id="invoiceType">
    <option value="Invoice">Invoice</option>
    <option value="Quote">Quote</option>
    <option value="Receipt">Receipt</option>
  </select>
</div>

<div class="section row-flex">
  <div>
    <h3>Your Info</h3>
    <input id="yourName" placeholder="Your Name / Business Name">
    <input id="yourEmail" placeholder="Email">
    <input id="yourPhone" placeholder="Phone">
  </div>
  <div>
    <h3>Client Info</h3>
    <input id="clientName" placeholder="Client Name">
    <input id="clientEmail" placeholder="Client Email">
    <input id="clientPhone" placeholder="Client Phone">
  </div>
</div>

<div class="section">
  <h3>Invoice Items</h3>
  <table id="itemsTable">
    <thead>
      <tr>
        <th>Item</th>
        <th>Category</th>
        <th>Quantity</th>
        <th>Price</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <button id="addItemBtn">Add Item</button>
</div>

<div class="section row-flex">
  <div>
    <label>Currency:</label>
    <select id="currencySelect"></select>
  </div>
  <div>
    <label>Discount %:</label>
    <input type="number" id="discount" value="0">
  </div>
  <div>
    <label>Tax %:</label>
    <input type="number" id="taxRate" value="0">
  </div>
  <div>
    <label>Payment Status:</label>
    <select id="paymentStatus">
      <option value="Unpaid">Unpaid</option>
      <option value="Paid">Paid</option>
    </select>
  </div>
</div>

<div class="section">
  <strong>Invoice Health:</strong>
  <div class="health-bar-container">
    <div class="health-bar" id="healthBar"></div>
  </div>
</div>

<button id="previewBtn">Preview Invoice</button>

<h3>Invoice Preview</h3>
<iframe id="invoicePreview"></iframe>

<script>
// Currency list
const currencies = ["USD","EUR","GBP","JPY","AUD","CAD","CNY","INR","BRL","ZAR","NZD"];
const currencySelect = document.getElementById('currencySelect');
currencies.forEach(c => { let opt=document.createElement('option'); opt.value=c; opt.textContent=c; currencySelect.appendChild(opt); });

// Categories
const categories = {
  "Web Design":["UI/UX","Landing Pages","Full Websites"],
  "Hosting & IT":["Cloud","Server","Maintenance"],
  "Maintenance & Repairs":["Electrical","Plumbing","Cleaning"],
  "Consulting":["Business","Legal","HR"],
  "Marketing":["Digital","Print","Events"],
  "Retail":["Clothing","Electronics","Groceries"],
  "Misc":["Other"]
};

// Items array
let items = [];
const itemsTableBody = document.querySelector("#itemsTable tbody");
const addItemBtn = document.getElementById("addItemBtn");

// Create item row
function createItemRow() {
  const rowIndex = items.length;
  items.push({name:"",category:"",qty:1,price:0});
  
  const tr = document.createElement("tr");
  tr.innerHTML = `
    <td><input type="text" placeholder="Item name"></td>
    <td><select></select></td>
    <td><input type="number" value="1" min="1"></td>
    <td><input type="number" value="0" min="0"></td>
  `;
  
  // Populate category select
  const catSelect = tr.children[1].querySelector("select");
  Object.keys(categories).forEach(cat=>{
    let opt=document.createElement("option");
    opt.value=cat; opt.textContent=cat;
    catSelect.appendChild(opt);
  });
  
  // Event listeners
  const nameInput = tr.children[0].querySelector("input");
  const qtyInput = tr.children[2].querySelector("input");
  const priceInput = tr.children[3].querySelector("input");
  
  nameInput.addEventListener("input",()=>{ items[rowIndex].name=nameInput.value; updateHealth(); });
  catSelect.addEventListener("change",()=>{ items[rowIndex].category=catSelect.value; updateHealth(); });
  qtyInput.addEventListener("input",()=>{ items[rowIndex].qty=parseInt(qtyInput.value)||1; updateHealth(); });
  priceInput.addEventListener("input",()=>{ items[rowIndex].price=parseFloat(priceInput.value)||0; updateHealth(); });
  
  itemsTableBody.appendChild(tr);
}
addItemBtn.addEventListener("click", createItemRow);
createItemRow(); // initial row

// Health bar
const healthBarEl = document.getElementById("healthBar");
function updateHealth(){
  let totalFields = items.length*3 + 6;
  let filled = 0;
  items.forEach(it=>{
    if(it.name) filled++;
    if(it.category) filled++;
    if(it.qty>0) filled++;
    if(it.price>0) filled++;
  });
  ['yourName','yourEmail','yourPhone','clientName','clientEmail','clientPhone'].forEach(id=>{
    if(document.getElementById(id).value.trim()!=="") filled++;
  });
  let score=Math.min(100, Math.round((filled/totalFields)*80 + 10));
  healthBarEl.style.width=score+"%";
  healthBarEl.style.backgroundColor = score<40?"red":score<70?"yellow":"#2f855a"; // green
}
document.querySelectorAll('input, select').forEach(el=>{
  el.addEventListener("input",updateHealth);
  el.addEventListener("change",updateHealth);
});
updateHealth();

// Invoice preview
document.getElementById("previewBtn").addEventListener("click",()=>{
  const currency = currencySelect.value;
  let subtotal=0;
  let html=`<div style="font-family:Inter,sans-serif;padding:15px;">
  <h2 style="color:#2f855a;">${document.getElementById("invoiceType").value}</h2>
  <table border="0" cellpadding="5" cellspacing="0" style="border-collapse:collapse;width:100%;border-radius:8px;overflow:hidden;">
  <tr style="background:#a7f3d0;font-weight:600;"><th>Item</th><th>Category</th><th>Qty</th><th>Price (${currency})</th><th>Total</th></tr>`;
  
  items.forEach((it,i)=>{
    const total=it.qty*it.price;
    subtotal+=total;
    const bgColor = i%2===0 ? '#f0fdf4' : '#ffffff';
    html+=`<tr style="background:${bgColor};"><td>${it.name}</td><td>${it.category}</td><td>${it.qty}</td><td>${it.price.toFixed(2)}</td><td>${total.toFixed(2)}</td></tr>`;
  });
  
  const discount=parseFloat(document.getElementById("discount").value)||0;
  const tax=parseFloat(document.getElementById("taxRate").value)||0;
  const discounted=subtotal*(1-discount/100);
  const total=discounted*(1+tax/100);
  
  html+=`</table>
  <p>Subtotal: ${subtotal.toFixed(2)} ${currency}</p>
  <p>Discount: ${discount}%</p>
  <p>Tax: ${tax}%</p>
  <h3 style="color:red;">Total: ${total.toFixed(2)} ${currency}</h3>
  <p>Payment Status: ${document.getElementById("paymentStatus").value}</p>
  </div>`;
  
  document.getElementById("invoicePreview").srcdoc=html;
});
</script>

</body>
</html>
