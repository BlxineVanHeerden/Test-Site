<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice Generator</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
body{
  font-family:Inter,sans-serif;
  background:#f8fafc;
  padding:20px;
}
h1{text-align:center;color:#1e40af}
.section{
  background:white;
  padding:16px;
  border-radius:14px;
  margin-bottom:20px;
  box-shadow:0 6px 18px rgba(0,0,0,.06);
}
input,select,textarea,button{
  width:100%;
  padding:9px;
  margin-top:6px;
  border-radius:8px;
  border:1px solid #cbd5e1;
}
button{
  background:#1e40af;
  color:white;
  cursor:pointer;
  font-weight:600;
}
button:hover{background:#1e3a8a}
.row{display:flex;gap:12px;flex-wrap:wrap}
.row>div{flex:1;min-width:200px}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:12px;
}
th,td{
  padding:10px;
  border-bottom:1px solid #e5e7eb;
}
th{
  background:#e5e7eb;
  color:#1f2937;
}

.health-wrap{
  background:#e5e7eb;
  height:10px;
  border-radius:20px;
  overflow:hidden;
}
.health-bar{
  height:100%;
  width:0%;
  transition:.3s;
}

iframe{
  width:100%;
  height:650px;
  border-radius:14px;
  border:1px solid #e5e7eb;
}
</style>
</head>
<body>

<h1>Invoice Generator</h1>

<div class="section row">
  <div>
    <label>Document Type</label>
    <select id="docType">
      <option value="INV">Invoice</option>
      <option value="QUO">Quote</option>
      <option value="REC">Receipt</option>
    </select>
  </div>
  <div>
    <label>Invoice Number</label>
    <input id="invoiceNumber" readonly>
  </div>
</div>

<div class="section row">
  <div>
    <h3>Your Info</h3>
    <input id="fromName" placeholder="Business name">
    <input id="fromEmail" placeholder="Email">
    <input type="file" id="logoInput">
  </div>
  <div>
    <h3>Client Info</h3>
    <input id="toName" placeholder="Client name">
    <input id="toEmail" placeholder="Client email">
  </div>
</div>

<div class="section">
  <h3>Invoice Items</h3>
  <table id="itemsTable">
    <thead>
      <tr>
        <th>Item</th>
        <th>Category</th>
        <th>Qty</th>
        <th>Price</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <button onclick="addItem()">Add Item</button>
</div>

<div class="section row">
  <div>
    <label>Currency</label>
    <select id="currency">
      <option value="$">USD ($)</option>
      <option value="€">EUR (€)</option>
      <option value="£">GBP (£)</option>
      <option value="R">ZAR (R)</option>
      <option value="¥">JPY (¥)</option>
    </select>
  </div>
  <div>
    <label>Tax %</label>
    <input type="number" id="tax" value="0">
  </div>
  <div>
    <label>Discount %</label>
    <input type="number" id="discount" value="0">
  </div>
</div>

<div class="section">
  <label>Client Note</label>
  <textarea id="note" placeholder="Optional note for your client"></textarea>
</div>

<div class="section">
  <strong>Invoice Health</strong>
  <div class="health-wrap">
    <div id="healthBar" class="health-bar"></div>
  </div>
</div>

<button onclick="previewInvoice()">Preview Invoice</button>

<h3>Preview</h3>
<iframe id="preview"></iframe>

<script>
const categories=[
"Professional Services","Consulting","Construction","Automotive",
"Healthcare","Education","Retail","Manufacturing","Hospitality",
"Logistics","Freelance","Agriculture","Media","Legal","Finance",
"Real Estate","IT & Technology","Cleaning","Security","Events","Miscellaneous"
];

let items=[];
let logoData=null;

function generateInvoiceNumber(){
  const type=document.getElementById("docType").value;
  document.getElementById("invoiceNumber").value=
    `${type}-${Math.floor(100000+Math.random()*900000)}`;
}
generateInvoiceNumber();
document.getElementById("docType").addEventListener("change",generateInvoiceNumber);

document.getElementById("logoInput").addEventListener("change",e=>{
  const reader=new FileReader();
  reader.onload=()=>logoData=reader.result;
  reader.readAsDataURL(e.target.files[0]);
});

function addItem(){
  const i=items.length;
  items.push({name:"",cat:"",qty:1,price:0});
  const tr=document.createElement("tr");
  tr.innerHTML=`
    <td><input oninput="items[${i}].name=this.value;updateHealth()"></td>
    <td>
      <select onchange="items[${i}].cat=this.value;updateHealth()">
        ${categories.map(c=>`<option>${c}</option>`).join("")}
      </select>
    </td>
    <td><input type="number" value="1" min="1"
      oninput="items[${i}].qty=this.value;updateHealth()"></td>
    <td><input type="number" value="0" min="0"
      oninput="items[${i}].price=this.value;updateHealth()"></td>
  `;
  document.querySelector("#itemsTable tbody").appendChild(tr);
}
addItem();

function updateHealth(){
  let score=0;
  ["fromName","toName","fromEmail","toEmail"].forEach(id=>{
    if(document.getElementById(id).value) score+=10;
  });
  items.forEach(i=>{
    if(i.name) score+=10;
    if(i.price>0) score+=10;
  });
  score=Math.min(score,100);
  const bar=document.getElementById("healthBar");
  bar.style.width=score+"%";
  bar.style.background=score<40?"#ef4444":score<70?"#facc15":"#22c55e";
}
document.addEventListener("input",updateHealth);

function previewInvoice(){
  let cur=document.getElementById("currency").value;
  let subtotal=0;
  let rows=items.map(i=>{
    let t=i.qty*i.price;
    subtotal+=t;
    return `<tr>
      <td>${i.name}</td><td>${i.cat}</td><td>${i.qty}</td><td>${cur}${t.toFixed(2)}</td>
    </tr>`;
  }).join("");

  let tax=subtotal*(tax.value/100);
  let disc=subtotal*(discount.value/100);
  let total=subtotal+tax-disc;

  preview.srcdoc=`
  <div style="font-family:Inter;padding:24px">
    ${logoData?`<img src="${logoData}" style="max-height:60px">`:``}
    <h2>${docType.options[docType.selectedIndex].text}</h2>
    <p><strong>${fromName.value}</strong> → ${toName.value}</p>
    <table style="width:100%;border-collapse:collapse">
      <tr style="background:#e5e7eb"><th>Item</th><th>Category</th><th>Qty</th><th>Total</th></tr>
      ${rows}
    </table>
    <h3>Total: ${cur}${total.toFixed(2)}</h3>
    <p>${note.value}</p>
  </div>`;
}
</script>

</body>
</html>
