<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Invoice Generator - Plans</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* --- Base --- */
body{font-family:Inter,sans-serif;background:#f5f7fb;padding:20px;color:#1f2937;}
h1{text-align:center;color:#111827;font-weight:700;margin-bottom:10px;}
h2,h3{color:#1f2937;}
.section{background:#fff;padding:20px;border-radius:16px;margin-bottom:24px;box-shadow:0 10px 25px rgba(0,0,0,.06);transition:all .3s;}
input,select,textarea,button{width:100%;padding:10px 12px;margin-top:8px;border-radius:8px;border:1px solid #d1d5db;font-size:14px;box-sizing:border-box;transition:border .3s,background .3s,color .3s;}
input:focus, select:focus, textarea:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px rgba(59,130,246,0.2);}
button{font-weight:600;border:none;cursor:pointer;transition:all .2s;background:#3b82f6;color:#fff;}
button:hover{background:#2563eb;}
.button-group{display:flex;gap:12px;flex-wrap:wrap;}
.button-group button{flex:1;padding:10px;font-size:14px;}
.row{display:flex;gap:16px;flex-wrap:wrap}
.row>div{flex:1;min-width:200px}
.flex-row{display:flex;gap:16px;}
.flex-column{display:flex;flex-direction:column;gap:10px;}
table{width:100%;border-collapse:collapse;margin-top:12px;}
th,td{padding:12px;border-bottom:1px solid #e5e7eb;}
th{background:#f3f4f6;text-align:left;}
.badge{display:inline-block;padding:6px 14px;border-radius:999px;font-size:13px;font-weight:600;background:#d1d5db;color:#374151;}
.blue{background:#3b82f6;color:#fff;}
.green{background:#22c55e;color:#fff;}
.red{background:#ef4444;color:#fff;}
.tooltip{position:relative;display:inline-block;}
.tooltip .tooltiptext{visibility:hidden;width:200px;background-color:#111;color:#fff;text-align:left;border-radius:6px;padding:6px 10px;position:absolute;z-index:1;bottom:125%;left:50%;margin-left:-100px;opacity:0;transition:opacity 0.3s;font-size:12px;}
.tooltip:hover .tooltiptext{visibility:visible;opacity:1;}
.tooltip-icon{display:inline-block;margin-left:6px;background:#3b82f6;color:#fff;border-radius:50%;width:16px;height:16px;font-size:11px;line-height:16px;text-align:center;}
.plan-card{border:1px solid #d1d5db;border-radius:16px;padding:20px;flex:1;cursor:pointer;text-align:center;transition:all .3s, transform .2s;background:#fff;}
.plan-card:hover{transform:translateY(-4px);box-shadow:0 12px 24px rgba(0,0,0,0.12);}
.plan-card.selected{border-color:#3b82f6;box-shadow:0 12px 28px rgba(59,130,246,0.2);}
.plan-price{font-size:22px;font-weight:700;margin:10px 0;background:linear-gradient(90deg,#3b82f6,#60a5fa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.plan-features{margin-top:12px;display:flex;flex-direction:column;gap:8px;}
.feature-btn{padding:6px 10px;border-radius:8px;font-size:13px;cursor:not-allowed;background:#e5e7eb;color:#374151;}
.feature-btn.unlocked{background:#3b82f6;color:#fff;cursor:pointer;transition:all .2s;}
.feature-btn.unlocked:hover{background:#2563eb;}
.remove-btn{background:#ef4444;padding:6px 12px;font-size:13px;border-radius:8px;cursor:pointer;color:#fff;transition:all .2s;}
.remove-btn:hover{background:#b91c1c;}
iframe{width:100%;height:720px;border-radius:16px;border:none;background:#f9fafb;box-shadow:0 10px 24px rgba(0,0,0,0.08);transition:all .3s;}
#note{height:90px;resize:vertical;}
#dueDate{padding:8px 10px;}
.paypal-btn-container{margin-top:12px;}
/* --- Invoice Preview Styling --- */
.invoice-card{background:#fff;border-radius:16px;padding:24px;box-shadow:0 10px 28px rgba(0,0,0,0.08);font-family:Inter,sans-serif;color:#1f2937;}
.invoice-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;}
.invoice-header h2{margin:0;background:linear-gradient(90deg,#3b82f6,#60a5fa);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.invoice-table{width:100%;border-collapse:collapse;margin-top:16px;}
.invoice-table th, .invoice-table td{padding:12px;text-align:left;}
.invoice-table th{background:#f3f4f6;border-bottom:2px solid #e5e7eb;}
.invoice-table td{border-bottom:1px solid #e5e7eb;}
.invoice-summary{margin-top:16px;display:flex;flex-direction:column;gap:6px;}
.invoice-summary div{display:flex;justify-content:space-between;padding:6px 12px;border-radius:8px;}
.invoice-summary div.total{background:linear-gradient(90deg,#3b82f6,#60a5fa);color:#fff;font-weight:700;}
.invoice-info{display:flex;gap:16px;margin-bottom:16px;flex-wrap:wrap;}
.invoice-box{flex:1;background:#f9fafb;padding:12px;border-radius:12px;}
.invoice-footer{margin-top:24px;background:#f3f4f6;padding:12px;border-radius:12px;}
</style>
</head>
<body>

<h1>Smart Invoice Generator</h1>

<h2>Select a Plan</h2>
<div class="row" id="planContainer">
  <div class="plan-card" data-plan="free">
    <h3>Free</h3>
    <div class="plan-price">$0</div>
    <div class="plan-features">
      <div>Max 2 items</div>
      <div>Invoice Preview Only</div>
    </div>
  </div>
  <div class="plan-card" data-plan="basic">
    <h3>Basic</h3>
    <div class="plan-price">$5/mo</div>
    <div class="plan-features">
      <div>Max 5 items</div>
      <div>Invoice PDF download</div>
      <div>Email notifications</div>
    </div>
  </div>
  <div class="plan-card" data-plan="pro">
    <h3>Pro</h3>
    <div class="plan-price">$10/mo</div>
    <div class="plan-features">
      <div>Unlimited items</div>
      <div>Custom branding</div>
      <div>Automated reminders</div>
    </div>
  </div>
</div>

<!-- Invoice Section -->
<div class="section row" id="invoiceSection">
  <div>
    <label>Document Type
      <span class="tooltip"><span class="tooltip-icon">i</span>
        <span class="tooltiptext">Choose whether this is an invoice, quote, or receipt</span>
      </span>
    </label>
    <select id="docType">
      <option value="INV">Invoice</option>
      <option value="QUO">Quote</option>
      <option value="REC">Receipt</option>
    </select>
  </div>
  <div>
    <label>Invoice Number
      <span class="tooltip"><span class="tooltip-icon">i</span>
        <span class="tooltiptext">Auto-generated invoice number</span>
      </span>
    </label>
    <div style="display:flex;gap:6px;">
      <input id="invoicePrefix" readonly style="width:60px;text-align:center;border-right:none;">
      <input id="invoiceNumber" style="flex:1;" placeholder="0001">
    </div>
  </div>
  <div>
    <label>Status
      <span class="tooltip"><span class="tooltip-icon">i</span>
        <span class="tooltiptext">Invoice status: Draft, Sent, or Paid</span>
      </span>
    </label>
    <select id="status">
      <option>Draft</option>
      <option>Sent</option>
      <option>Paid</option>
    </select>
  </div>
</div>

<div class="section row">
  <div>
    <h3>Your Info</h3>
    <input id="fromName" placeholder="Business name">
    <input id="fromEmail" placeholder="Email">
    <input id="fromPhone" placeholder="Contact number">
    <label>Logo (optional)</label>
    <input type="file" id="logoInput" accept="image/*">
  </div>
  <div>
    <h3>Client Info</h3>
    <input id="toName" placeholder="Client name">
    <input id="toEmail" placeholder="Client email">
    <input id="toPhone" placeholder="Client phone number">
  </div>
</div>

<div class="section">
  <h3>Invoice Items</h3>
  <table>
    <thead>
      <tr>
        <th>Item</th>
        <th>Category</th>
        <th>Qty</th>
        <th>Price</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="itemsBody"></tbody>
  </table>
  <button id="addItemBtn">Add Item</button>
</div>

<div class="section row">
  <div>
    <label>Currency</label>
    <select id="currency">
      <option value="$">USD ($)</option>
      <option value="€">EUR (€)</option>
      <option value="£">GBP (£)</option>
      <option value="R">ZAR (R)</option>
    </select>
  </div>
  <div>
    <label>Discount %</label>
    <input type="number" id="discount" value="0">
  </div>
  <div>
    <label>Tax %</label>
    <input type="number" id="tax" value="0">
  </div>
  <div>
    <label>Amount Paid</label>
    <input type="number" id="paid" value="0">
  </div>
</div>

<div class="section flex-row">
  <div class="flex-column" style="flex:1">
    <label>Payment Terms</label>
    <select id="terms">
      <option value="0">Due on receipt</option>
      <option value="7">Net 7</option>
      <option value="14">Net 14</option>
      <option value="30">Net 30</option>
    </select>
    <label>Due Date</label>
    <input type="date" id="dueDate">
  </div>
  <div style="flex:1">
    <label>Client Note</label>
    <textarea id="note"></textarea>
  </div>
</div>

<div class="button-group">
  <button onclick="updatePreview()">Preview Invoice</button>
  <button onclick="alert('Download PDF (Premium)')" class="feature-btn" id="pdfBtn">Download PDF</button>
  <button onclick="alert('Send Invoice (Premium)')" class="feature-btn" id="sendBtn">Send Invoice</button>
  <button onclick="alert('Save Invoice (Premium)')" class="feature-btn" id="saveBtn">Save</button>
</div>

<h3>Invoice Preview</h3>
<iframe id="preview"></iframe>

<!-- PayPal Sandbox Buttons -->
<div class="paypal-btn-container" id="paypalBtnContainer"></div>
<script src="https://www.paypal.com/sdk/js?client-id=sb&currency=USD"></script>

<script>
// --- Plan logic ---
const planButtons = document.querySelectorAll('.plan-card');
let selectedPlan = 'free';
planButtons.forEach(card => {
  card.addEventListener('click', () => {
    selectedPlan = card.getAttribute('data-plan');
    planButtons.forEach(c => c.classList.remove('selected'));
    card.classList.add('selected');
    updateFeatureAccess();
    renderPaypalButtons();
  });
});

function updateFeatureAccess() {
  const pdfBtn = document.getElementById('pdfBtn');
  const sendBtn = document.getElementById('sendBtn');
  const saveBtn = document.getElementById('saveBtn');
  if(selectedPlan==='free'){
    pdfBtn.classList.remove('unlocked');
    sendBtn.classList.remove('unlocked');
    saveBtn.classList.remove('unlocked');
  } else if(selectedPlan==='basic'){
    pdfBtn.classList.add('unlocked');
    sendBtn.classList.remove('unlocked');
    saveBtn.classList.add('unlocked');
  } else if(selectedPlan==='pro'){
    pdfBtn.classList.add('unlocked');
    sendBtn.classList.add('unlocked');
    saveBtn.classList.add('unlocked');
  }
}
updateFeatureAccess();

// --- Invoice logic ---
const categories=[
"Professional Services","Consulting","Construction","Automotive",
"Healthcare","Education","Retail","Manufacturing","Hospitality",
"Logistics","Freelance","Agriculture","Media","Legal","Finance",
"Real Estate","IT & Technology","Cleaning","Security","Events","Miscellaneous"
];

const counters={INV:0,QUO:0,REC:0};
const docType=document.getElementById("docType");
const invoicePrefix=document.getElementById("invoicePrefix");
const invoiceNumber=document.getElementById("invoiceNumber");

function updateInvoiceNumber(){
  counters[docType.value]++;
  invoicePrefix.value = docType.value;
  invoiceNumber.value = String(counters[docType.value]).padStart(4,"0");
}
updateInvoiceNumber();
docType.addEventListener("change",updateInvoiceNumber);

let items=[];
const itemsBody=document.getElementById("itemsBody");

function addItem(){
  const maxItems = selectedPlan==='free' ? 2 : selectedPlan==='basic' ? 5 : 999;
  if(items.length >= maxItems){
    alert(`${selectedPlan.charAt(0).toUpperCase()+selectedPlan.slice(1)} plan allows max ${maxItems} items. Upgrade for more.`);
    return;
  }

  const index=items.length;
  items.push({name:"",cat:"",qty:1,price:0});

  const tr=document.createElement("tr");

  const nameTd=document.createElement("td");
  const nameInput=document.createElement("input");
  nameInput.oninput=e=>{items[index].name=e.target.value; updatePreview();}
  nameTd.appendChild(nameInput);

  const catTd=document.createElement("td");
  const catSelect=document.createElement("select");
  categories.forEach(c=>{const o=document.createElement("option");o.textContent=c;catSelect.appendChild(o);});
  catSelect.onchange=e=>{items[index].cat=e.target.value;updatePreview();}
  catTd.appendChild(catSelect);

  const qtyTd=document.createElement("td");
  const qtyInput=document.createElement("input");
  qtyInput.type="number"; qtyInput.value=1; qtyInput.min=1;
  qtyInput.oninput=e=>{items[index].qty=Number(e.target.value);updatePreview();}
  qtyTd.appendChild(qtyInput);

  const priceTd=document.createElement("td");
  const priceInput=document.createElement("input");
  priceInput.type="number"; priceInput.value=0; priceInput.min=0;
  priceInput.oninput=e=>{items[index].price=Number(e.target.value);updatePreview();}
  priceTd.appendChild(priceInput);

  const actionTd=document.createElement("td");
  const removeBtn=document.createElement("button");
  removeBtn.className="remove-btn"; removeBtn.textContent="Remove";
  removeBtn.onclick=()=>{items.splice(index,1); tr.remove(); updatePreview();}
  actionTd.appendChild(removeBtn);

  tr.append(nameTd,catTd,qtyTd,priceTd,actionTd);
  itemsBody.appendChild(tr);
}

document.getElementById("addItemBtn").addEventListener("click",addItem);
addItem();

const terms=document.getElementById("terms");
const dueDate=document.getElementById("dueDate");

terms.addEventListener("change",()=>{
  const d=new Date();
  d.setDate(d.getDate()+Number(terms.value));
  dueDate.value=d.toISOString().split("T")[0];
  updatePreview();
});
terms.dispatchEvent(new Event("change"));

let logoData="";
document.getElementById("logoInput").addEventListener("change",e=>{
  const file=e.target.files[0];
  if(file){
    const reader=new FileReader();
    reader.onload=ev=>{ logoData=ev.target.result; updatePreview();}
    reader.readAsDataURL(file);
  }
});

["fromName","fromEmail","fromPhone","toName","toEmail","toPhone","discount","tax","paid","note","currency","status","invoiceNumber","dueDate"].forEach(id=>{
  document.getElementById(id).addEventListener("input",updatePreview);
});
invoicePrefix.addEventListener("input",()=>{invoicePrefix.value = docType.value;});

function updatePreview(){
  const cur=document.getElementById("currency").value;
  let subtotal=0;

  const rows=items.map(i=>{
    const t=i.qty*i.price;
    subtotal+=t;
    return `<tr>
      <td>${i.name||"-"}<br><small>${i.cat||""}</small></td>
      <td>${i.qty}</td>
      <td>${cur}${i.price.toFixed(2)}</td>
      <td>${cur}${t.toFixed(2)}</td>
    </tr>`;
  }).join("");

  const discount=Number(document.getElementById("discount").value);
  const tax=Number(document.getElementById("tax").value);
  const paid=Number(document.getElementById("paid").value);

  let total=subtotal*(1-discount/100)*(1+tax/100);
  const balance=total-paid;

  const html=`
    <div class="invoice-card">
      <div class="invoice-header">
        <h2>${document.getElementById("docType").value} ${document.getElementById("invoiceNumber").value}</h2>
        ${logoData ? `<img src="${logoData}" style="height:50px;border-radius:8px;">` : ""}
      </div>
      <div class="invoice-info">
        <div class="invoice-box">
          <strong>From:</strong><br>
          ${document.getElementById("fromName").value}<br>
          ${document.getElementById("fromEmail").value}<br>
          ${document.getElementById("fromPhone").value}
        </div>
        <div class="invoice-box">
          <strong>To:</strong><br>
          ${document.getElementById("toName").value}<br>
          ${document.getElementById("toEmail").value}<br>
          ${document.getElementById("toPhone").value}
        </div>
      </div>
      <table class="invoice-table">
        <thead><tr><th>Item</th><th>Qty</th><th>Price</th><th>Total</th></tr></thead>
        <tbody>${rows}</tbody>
      </table>
      <div class="invoice-summary">
        <div><span>Subtotal</span><span>${cur}${subtotal.toFixed(2)}</span></div>
        <div><span>Discount</span><span>${discount}%</span></div>
        <div><span>Tax</span><span>${tax}%</span></div>
        <div class="total"><span>Total</span><span>${cur}${total.toFixed(2)}</span></div>
        <div><span>Amount Paid</span><span>${cur}${paid.toFixed(2)}</span></div>
        <div><strong>Balance Due</strong><span>${cur}${balance.toFixed(2)}</span></div>
      </div>
      <div class="invoice-footer">
        <strong>Due Date:</strong> ${dueDate.value}<br>
        <strong>Note:</strong> ${document.getElementById("note").value}
      </div>
    </div>
  `;
  const preview=document.getElementById("preview");
  preview.srcdoc=html;
}

// --- PayPal Sandbox Buttons ---
function renderPaypalButtons(){
  const container=document.getElementById("paypalBtnContainer");
  container.innerHTML="";
  if(selectedPlan!=='free'){
    paypal.Buttons({
      createOrder:(data,actions)=>actions.order.create({purchase_units:[{amount:{value:selectedPlan==='basic'?5:10}}]}),
      onApprove:(data,actions)=>actions.order.capture().then(details=>alert("Payment completed: "+details.status))
    }).render('#paypalBtnContainer');
  }
}
renderPaypalButtons();
</script>

</body>
</html>
